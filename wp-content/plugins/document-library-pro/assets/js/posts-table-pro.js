!function(t,e,a){"use strict";const l={message:null,overlayCSS:{background:"#fff",opacity:.7}};function i(t){return function(e,a){"class"===e?t.addClass(a):t.attr(e,a)}}function n(e,a,l){l=void 0!==l?l:0,t.each(a,(function(t,a){let i=a.name,s="slug"in a?a.slug:i,r="";l&&(r=Array(2*l+1).join(" ")+"– "),e.append('<option value="'+s+'">'+r+i+"</option>"),"children"in a&&n(e,a.children,l+1)}))}function s(t,e){let a,l=JSON.parse(JSON.stringify(t));for(let t=l.length-1;t>=0;t--)a=l[t],a.hasOwnProperty("children")&&(a.children=s(a.children,e),0===a.children.length&&delete a.children),-1!==e.indexOf(a.slug)||a.hasOwnProperty("children")||l.splice(t,1);return l}function r(t,e,a){let l=[{slug:"",name:e}].concat(a);t.empty(),n(t,l)}function o(a){a&&a.length&&(a.find(".ptp-playlist").addClass("wp-playlist"),a.find(".ptp-video-shortcode").addClass("wp-video-shortcode"),a.find(".ptp-audio-shortcode").addClass("wp-audio-shortcode"),"undefined"!=typeof WPPlaylistView&&a.find(".wp-playlist:not(:has(.mejs-container))").each((function(){return new WPPlaylistView({el:this})})),"wp"in e&&"mediaelement"in e.wp&&t(e.wp.mediaelement.initialize),t.fn.fitVids&&a.fitVids())}function d(){return function(e,a,l){let i=e.row(a).node().className,n=t.map(l,(function(t){let e=t.className?'class="'+t.className+'"':"";return t.hidden?"<li "+e+' data-dtr-index="'+t.columnIndex+'" data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><span class="dtr-title">'+t.title+'</span> <span class="dtr-data">'+t.data+"</span></li>":""})).join("");return!!n&&t('<ul data-dtr-index="'+a+'" class="dtr-details '+i+'" />').append(n)}}function c(){return"select2"in t.fn&&a.enable_select2}let p=function(a){this.$table=a,this.id=a.attr("id"),this.dataTable=null,this.config=null,this.ajaxData=[],this.hasAdminBar=t("#wpadminbar").length>0,this.$filters=[],this.$tableWrapper=this.$table.parent(),this.$pagination=this.$tableWrapper.find(".dataTables_paginate"),this.$tableControls=this.$tableWrapper.find(".posts-table-controls"),a.on("draw.dt",{table:this},h).on("init.dt",{table:this},b).on("page.dt",{table:this},$).on("processing.dt",{table:this},v).on("responsive-display.dt",{table:this},y).on("search.dt",{table:this},_).on("xhr.dt",{table:this},f),t(e).on("load.ptp",{table:this},T),a.addClass("loading").css("visibility","visible")};function f(e,a,l){let i=e.data.table;null!==l&&"data"in l&&t.isArray(l.data)&&(i.ajaxData=l.data),i.$table.trigger("lazyload.ptp",[i])}function u(e){let a=t(this),l=e.data.table,i=a.data("column"),n=a.children("[data-slug]").length?a.children("[data-slug]").data("slug"):"";if(""===n)return!0;if(l.$filters.length){let t=l.$filters.filter('[data-column="'+i+'"]').first();if(t.length&&t.children('option[value="'+n+'"]').length)return t.val(n).trigger("change"),l.scrollToTop(),!1}let s=l.getDataTable().column(i+":name");if(l.config.serverSide)s.search(n).draw();else{let e="(^|, )"+t.fn.dataTable.util.escapeRegex(a.text())+"(, |$)";s.search(e,!0,!1).draw()}return l.scrollToTop(),!1}function h(t){let e=t.data.table;e.config.serverSide&&e.processAjaxData(),o(e.$table),e.showHidePagination().$table.trigger("draw.ptp",[e])}function g(e,l){let i=t(this),n=e.data.table;if(l)return!0;n.$table.off("search.dt",_);let s=i.val(),r=i.data("column"),o=n.getDataTable().column(i.data("searchColumn")+":name");if(n.config.serverSide)o.search(s).draw();else{let e=a.filter_term_separator;""!==s&&(s=t.fn.dataTable.util.escapeRegex(s),s=`(^|${e})${s}(${e}|$)`),o.search(s,!0,!1).draw()}let d=n.$filters.filter('[data-column="'+r+'"]'),c=n.$filters.not(d);d.not(i[0]).val(s).trigger("change",[!0]),n.updateFilterOptions(c),n.$table.on("search.dt",{table:n},_)}function b(e){let a=e.data.table;a.$tableWrapper=a.$table.parent(),a.$pagination=a.$tableWrapper.find(".dataTables_paginate"),a.$tableControls=a.$tableWrapper.find(".posts-table-controls"),a.initFilters().initSelect2().initResetButton().initSearchOnClick().initPhotoswipe().showHidePagination(),!a.config.serverSide&&t.fn.fitVids&&a.$table.fitVids(),a.$table.removeClass("loading").trigger("init.ptp",[a])}function m(e){if(e.stopPropagation(),"click"!==e.type)return!1;let a=t(".pswp")[0],l=t(e.target).closest(".posts-table-gallery__image"),i=[];return l.length>0&&l.each((function(e,a){let l=t(a).find("img"),n={src:l.attr("data-large_image"),w:l.attr("data-large_image_width"),h:l.attr("data-large_image_height"),title:l.attr("data-caption")&&l.attr("data-caption").length?l.attr("data-caption"):l.attr("title")};i.push(n)})),new PhotoSwipe(a,PhotoSwipeUI_Default,i,{index:0,shareEl:!1,closeOnScroll:!1,history:!1,hideAnimationDuration:0,showAnimationDuration:0}).init(),!1}function $(t){t.data.table.scrollToTop()}function v(t,e,a){a?t.data.table.$table.block(l):t.data.table.$table.unblock()}function w(t){t.preventDefault();let e=t.data.table,a=e.getDataTable();e.$table.off("search.dt",_),e.$table.find("tr.child").remove(),e.$table.find("tr.parent").removeClass("parent"),a.columns('th[data-searchable="true"]').search("");let l=e.$table.attr("data-order");if(l.length){let t=l.replace(/[\[\]" ]+/g,"").split(",");2===t.length&&a.order(t)}let i="search"in e.config&&"search"in e.config.search?e.config.search.search:"";a.search(i).page.len(e.config.pageLength).draw(!0),c()&&e.$tableControls.find(".dataTables_length select").trigger("change"),e.$filters.length&&(e.$filters.val("").trigger("change",[!0]),e.updateFilterOptions(e.$filters)),e.$table.on("search.dt",{table:e},_)}function y(t,e,a,l){if(l&&void 0!==a.child()){o(a.child());let i=t.data.table;i.$table.trigger("responsiveDisplay.ptp",[i,e,a,l])}}function _(t,e){let a=t.data.table;a.updateFilterOptions(a.$filters)}function T(t){let e=t.data.table;e.getDataTable().columns.adjust().responsive.recalc(),e.$table.trigger("load.ptp",[e])}p.prototype.buildConfig=function(){let e={retrieve:!0,responsive:t.fn.dataTable.Responsive.defaults,processing:!0,orderMulti:!1,language:a.language},l=this.$table.data("config");var i;return l&&(e=t.extend(!0,{},e,l)),"totalsPlural"in e.language&&"info"in e.language&&-1!==e.language.info.indexOf(e.language.totalsPlural)&&(e.infoCallback=function(t,a,l,i,n,s){return s&&1===n&&(s=s.replace(e.language.totalsPlural,e.language.totalsSingle)),s}),e.serverSide&&"ajax_url"in a&&(e.deferRender=!0,e.ajax={url:a.ajax_url,type:"POST",data:{table_id:this.id,action:a.ajax_action,_ajax_nonce:a.ajax_nonce},xhrFields:{withCredentials:!0}}),"object"==typeof e.responsive&&"details"in e.responsive&&"display"in e.responsive.details&&("child_row"===e.responsive.details.display?(e.responsive.details.display=t.fn.dataTable.Responsive.display.childRow,e.responsive.details.renderer=d()):"child_row_visible"===e.responsive.details.display?(e.responsive.details.display=t.fn.dataTable.Responsive.display.childRowImmediate,e.responsive.details.renderer=d()):"modal"===e.responsive.details.display&&(e.responsive.details.display=t.fn.dataTable.Responsive.display.modal(),e.responsive.details.renderer=(i={tableClass:a.table_class},i=t.extend({tableClass:""},i),function(e,a,l){let n='<ul data-dtr-index="'+a+'" class="dtr-details '+e.row(a).node().className+'" >'+t.map(l,(function(t){return e.column(t.columnIndex).visible()?"<li "+(t.className?'class="'+t.className+'"':"")+' data-dtr-index="'+t.columnIndex+'" data-dt-row="'+t.rowIndex+'" data-dt-column="'+t.columnIndex+'"><span class="dtr-title">'+t.title+'</span> <span class="dtr-data">'+t.data+"</span></li>":""})).join("")+"</ul>",s=t('<div class="'+i.tableClass+'" />').append(n);o(s);let r=s.find(".posts-table-image-wrapper > a > img");return r.length&&(r.parent().parent().prepend(r),r.siblings("a").remove()),s}))),"lang_url"in a&&(e.language={url:a.lang_url}),e},p.prototype.getDataTable=function(){return this.dataTable||this.init(),this.dataTable},p.prototype.init=function(){let t=this;return t.$table.trigger("preInit.ptp",[t]),t.config=t.buildConfig(),t.dataTable=t.$table.DataTable(t.config),t},p.prototype.initFilters=function(){let e=this,l=e.$table.data("filters");if(!l)return e;let i=t('<div class="posts-table-select-filters" id="'+e.id+'_select_filters" />'),n=0;"filterBy"in a.language&&a.language.filterBy&&i.append('<label class="filter-label">'+a.language.filterBy+"</label>");for(let a in l){let s=l[a];if(!("terms"in s)||0===s.terms.length)continue;let o={name:"ptp_filter_"+a,"data-tax":s.taxonomy,"data-column":a,"data-search-column":s.searchColumn,"aria-label":s.heading,"data-placeholder":s.heading};s.class&&(o.class=s.class);let d=t("<select/>").attr(o);r(d,s.heading,s.terms),d.on("change.ptp",{table:e},g).appendTo(i),n++}if(n>0){let t=e.$tableControls.find(".dataTables_filter");t.length?i.prependTo(t.closest(".posts-table-controls")):i.prependTo(e.$tableControls.filter(".posts-table-above"))}return e.$filters=e.$tableControls.find(".posts-table-select-filters select"),e.updateFilterOptions(e.$filters),e},p.prototype.initPhotoswipe=function(){return"undefined"==typeof PhotoSwipe||"undefined"==typeof PhotoSwipeUI_Default||this.$table.on("click.ptp",".posts-table-gallery__image a",m),this},p.prototype.initResetButton=function(){let e=this;if(!e.config.resetButton)return e;let l=t('<div class="posts-table-reset"><a class="reset" href="#">'+a.language.resetButton+"</a></div>").on("click.ptp","a",{table:e},w),i=e.$tableControls.filter(".posts-table-above").children(".posts-table-select-filters, .dataTables_length, .dataTables_filter").eq(0);return i.length?i.append(l):e.$tableControls.filter(".posts-table-above").prepend(l),e},p.prototype.initSearchOnClick=function(){let t=this;return t.config.clickFilter&&t.$table.on("click.ptp","a[data-column]",{table:t},u),this},p.prototype.initSelect2=function(){let e=this;if(!c())return e;let a={dropdownCssClass:"posts-table-dropdown",escapeMarkup:function(t){return t}};return e.$filters.length&&(e.$filters.each((function(){t(this).innerWidth()===t(this).width()&&t(this).width(t(this).width()+22)})),e.$filters.select2(Object.assign(a,{minimumResultsForSearch:5}))),e.$tableControls.find(".dataTables_length select").select2(Object.assign(a,{minimumResultsForSearch:-1})),e},p.prototype.processAjaxData=function(){let e=this;if(!e.config.serverSide||!e.ajaxData.length)return;let a=e.$table.find("tbody tr");for(let l=0;l<e.ajaxData.length;l++)"__attributes"in e.ajaxData[l]&&a.eq(l).length&&t.each(e.ajaxData[l].__attributes,i(a.eq(l)));return e},p.prototype.scrollToTop=function(){let e=this,a=e.config.scrollOffset;if(!1!==a&&!isNaN(a)){let l=e.$tableWrapper.offset().top-a;e.hasAdminBar&&(l-=32),t("html,body").animate({scrollTop:l},300)}return e},p.prototype.showHidePagination=function(){let t=this;if(t.$pagination.length){let e=t.getDataTable().page.info();e&&e.pages<=1?t.$pagination.hide(0):t.$pagination.show()}return t},p.prototype.updateFilterOptions=function(e){let l=this;if(!e.length||l.config.serverSide)return l;let i=l.$table.data("filters");return e.each((function(){let e=t(this),n=e.data("column"),o=e.val();if(!(n in i))return;let d=i[n],c=d.terms,p=l.getDataTable().column(e.data("searchColumn")+":name",{search:"applied"}).data().filter((function(t){return t.length>0}));if(p.any()){let t=a.filter_term_separator;c=s(c,p.join(t).split(t))}else c=[];r(e,d.heading,c),e.val(o)})),l},t.fn.postsTable=function(){return this.each((function(){new p(t(this)).init()}))},t((function(){"DataTable"in t.fn&&t.fn.DataTable.ext&&(t.fn.DataTable.ext.errMode="throw"),t("."+a.table_class).postsTable()}))}(jQuery,window,posts_table_params);